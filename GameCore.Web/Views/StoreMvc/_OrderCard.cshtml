@model GameCore.Core.DTOs.OrderDto

<div class="order-header">
    <div>
        <div class="order-number">訂單編號：@Model.OrderNumber</div>
        <div class="order-date">下單時間：@Model.CreatedAt.ToString("yyyy-MM-dd HH:mm")</div>
    </div>
    <div>
        @{
            var statusClass = Model.Status switch
            {
                "pending" => "status-pending",
                "processing" => "status-processing",
                "shipped" => "status-shipped",
                "completed" => "status-completed",
                "cancelled" => "status-cancelled",
                _ => "status-pending"
            };
            
            var statusText = Model.Status switch
            {
                "pending" => "待處理",
                "processing" => "處理中",
                "shipped" => "已出貨",
                "completed" => "已完成",
                "cancelled" => "已取消",
                _ => "待處理"
            };
        }
        <span class="order-status @statusClass">@statusText</span>
    </div>
</div>

<div class="order-items">
    @foreach (var item in Model.OrderItems)
    {
        <div class="order-item">
            <img src="@(string.IsNullOrEmpty(item.ProductImageUrl) ? "/images/placeholder-product.jpg" : item.ProductImageUrl)" 
                 alt="@item.ProductName" 
                 class="order-item-image"
                 onerror="this.src='/images/placeholder-product.jpg'">
            <div class="flex-grow-1">
                <div class="fw-bold">@item.ProductName</div>
                <div class="text-muted small">
                    數量：@item.Quantity × NT$ @item.UnitPrice.ToString("N0")
                </div>
            </div>
            <div class="fw-bold text-end">
                NT$ @((item.Quantity * item.UnitPrice).ToString("N0"))
            </div>
        </div>
    }
</div>

<div class="order-summary">
    <div class="summary-row">
        <span>商品小計：</span>
        <span>NT$ @Model.Subtotal.ToString("N0")</span>
    </div>
    <div class="summary-row">
        <span>運費：</span>
        <span>NT$ @Model.ShippingFee.ToString("N0")</span>
    </div>
    @if (Model.DiscountAmount > 0)
    {
        <div class="summary-row">
            <span>折扣：</span>
            <span class="text-success">-NT$ @Model.DiscountAmount.ToString("N0")</span>
        </div>
    }
    <div class="summary-row">
        <span>訂單總計：</span>
        <span>NT$ @Model.TotalAmount.ToString("N0")</span>
    </div>
</div>

@if (!string.IsNullOrEmpty(Model.ShippingAddress))
{
    <div class="mb-3">
        <strong>收貨地址：</strong>
        <div class="text-muted">@Model.ShippingAddress</div>
    </div>
}

@if (!string.IsNullOrEmpty(Model.PaymentMethod))
{
    <div class="mb-3">
        <strong>付款方式：</strong>
        <span class="text-muted">@Model.PaymentMethod</span>
    </div>
}

@if (!string.IsNullOrEmpty(Model.Notes))
{
    <div class="mb-3">
        <strong>備註：</strong>
        <div class="text-muted">@Model.Notes</div>
    </div>
}

<div class="order-actions">
    @if (Model.Status == "pending")
    {
        <button class="btn btn-outline-danger btn-sm" onclick="cancelOrder('@Model.Id')">
            <i class="fas fa-times me-1"></i>
            取消訂單
        </button>
    }
    
    @if (Model.Status == "completed")
    {
        <button class="btn btn-outline-primary btn-sm">
            <i class="fas fa-star me-1"></i>
            評價商品
        </button>
    }
    
    <button class="btn btn-outline-secondary btn-sm" onclick="window.print()">
        <i class="fas fa-print me-1"></i>
        列印訂單
    </button>
    
    <a href="@Url.Action("OrderConfirmation", "StoreMvc", new { orderId = Model.Id })" 
       class="btn btn-primary btn-sm">
        <i class="fas fa-eye me-1"></i>
        查看詳情
    </a>
</div> 